% A ConTeXt document [master document: literateModules.tex]

\startchapter[title=MkIV code]

\startMkIVCode

%D \section{MkIV code environment}

%D \subsection{Examples}

%D \subsection{Implementation: start (MkIV)}

%\definetyping[MkIVCode]
%\setuptyping[MkIVode][option=lua]

\stopMkIVCode

\startMkIVAltCode

%D \subsection{Implementation: stop (MkIV)}

%\let\oldStopMkIVCode=\stopMkIVCode
%def\stopMkIVCode{%
%  \oldStopMkIVCode%
% \directlua{thirddata.literateModules.addMkIVCode('_typing_')}}

\stopMkIVAltCode

\startMkIVCode

%D \subsection{Implementation: start (MkIVAlt)}

%\definetyping[MkIVAltCode]
%\setuptyping[MkIVAltCode][option=lua]

%D \subsection{Implementation: stop (MkIVAlt)}

%\let\oldStopMkIVAltCode=\stopMkIVAltCode
%def\stopMkIVAltCode{%
%  \oldStopMkIVAltCode%
% \directlua{thirddata.literateModules.addMkIVCode('_typing_')}}

%D \subsection{Implementation: createFile}

%\def\createMkIVFile[#1]{
%  \directlua{thirddata.literateModules.createMkIVFile(#1)}
%}

\stopMkIVCode

\startLuaCode
function litMods.addMkIVCode(bufferName)
  table_insert(code.mkiv, buffers.getcontent(bufferName))
end

function litMods.createMkIVFile(aFilePath)
  renderFile(aFilePath, litMods.templates.mkIVFile)
end
\stopLuaCode

\startLuaTemplate


\stopLuaTemplate

\stopchapter