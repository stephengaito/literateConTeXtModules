% A ConTeXt document [master document: literateModules.tex]

\startchapter[title=MkIV code]

\startSillyCode

%D \section{MkIV code environment}

%D \subsection{Examples}

%D \subsection{Implementation: start}

\definetyping[SillyCode]
\setuptyping[SillyCode][option=lua]

%D \subsection{Implementation: stop}

%\let\oldStopSillyCode=\stopSillyCode
%def\stopSillyCode{%
%  \oldStopSillyCode%
% \directlua{thirddata.literateModules.addModuleCode('_typing_')}}
  
%D \subsection{Implementation: createFile}

\def\createMkIVFile[#1]{
  \directlua{thirddata.literateModules.createMkIVFile(#1)}
}

\stopSillyCode

\startLuaCode
function litMods.addMkIVCode(bufferName)
  table_insert(code.mkiv, buffers.getcontent(bufferName))
end

function litMods.createMkIVFile(aFilePath)
  renderFile(aFilePath, litMods.templates.mkIVFile)
end
\stopLuaCode

\startLuaTemplate


\stopLuaTemplate

\stopchapter